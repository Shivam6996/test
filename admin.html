<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel - Roblox ID Shop</title>
<link rel="stylesheet" href="style.css">
<style>
/* Extra styling for admin dashboard */
#dashboard { display: none; max-width: 600px; margin: 2rem auto; }
form input, form button { width: 100%; padding: 12px; margin-bottom: 0.8rem; border-radius: 6px; border: 1px solid #ddd; font-size: 0.95rem; }
form input:focus { outline: none; border-color: #febd69; box-shadow: 0 0 4px rgba(254,189,105,0.8); }
form button { background: #febd69; border: none; font-weight: bold; cursor: pointer; transition: background 0.3s; }
form button:hover { background: #f3a847; }
#admin-items-list { list-style: none; padding:0; margin-top:1rem; }
#admin-items-list li { background:#fff;padding:10px;border-radius:6px;margin-bottom:8px;box-shadow:0 1px 4px rgba(0,0,0,0.1); }
</style>
</head>
<body>
<header>
  <h1>Admin Panel</h1>
  <nav>
    <a href="index.html">Shop</a>
    <a href="#" onclick="doLogout()">Logout</a>
  </nav>
</header>

<main>
  <div id="dashboard">
    <h2>Dashboard</h2>
    <form id="add-item-form">
      <input type="text" id="item-name" placeholder="Item Name" required>
      <input type="text" id="item-id" placeholder="Roblox ID" required>
      <input type="number" id="item-price" placeholder="Price" required>
      <button type="submit">Add Item</button>
    </form>

    <h3>Current Items</h3>
    <ul id="admin-items-list"></ul>
  </div>
</main>

<footer>
  <p>Â© 2025 Roblox ID Shop</p>
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

// 1. Replace this with your Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyC_KqYOD1QkQXiTpiRi7L3QsO-cwrsrUXA",
  authDomain: "roblox-shop-1878d.firebaseapp.com",
  projectId: "roblox-shop-1878d",
  appId: "1:675280968126:web:ccbfcb4f28fe69f74841ef"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

// 2. Allow only specific admin emails
const adminEmails = ["your.email@example.com"];

// 3. Protect admin dashboard
onAuthStateChanged(auth, user => {
  if (!user || !adminEmails.includes(user.email)) {
    alert("You are not authorized. Redirecting to login.");
    signOut(auth).then(() => window.location.href = 'login.html');
  } else {
    document.getElementById("dashboard").style.display = "block";
    loadAdminItems();
  }
});

// 4. Logout function
window.doLogout = () => signOut(auth).then(() => window.location.href='index.html');

// 5. Item management
document.getElementById("add-item-form").addEventListener("submit", e => {
  e.preventDefault();
  const name = document.getElementById("item-name").value;
  const id = document.getElementById("item-id").value;
  const price = document.getElementById("item-price").value;

  let items = JSON.parse(localStorage.getItem("shopItems")) || [];
  items.push({ name, id, price });
  localStorage.setItem("shopItems", JSON.stringify(items));

  e.target.reset();
  loadAdminItems();
});

function loadAdminItems() {
  const list = document.getElementById("admin-items-list");
  const items = JSON.parse(localStorage.getItem("shopItems")) || [];
  list.innerHTML = "";
  items.forEach((item, index) => {
    const li = document.createElement("li");
    li.textContent = `${item.name} - ${item.id} - $${item.price}`;
    list.appendChild(li);
  });
}

// Optional: show loader until auth check
window.onload = () => {
  const loader = document.getElementById("loader");
  if (loader) loader.style.display = "none";
};
</script>
</body>
</html>
